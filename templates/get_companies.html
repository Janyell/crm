{%extends "base.html"%}

{%block content%}
    <div class="container">
        <h2 class="center">{{ page_title }}</h2>
        {% if companies %}
            <table class="table table-hover table-bordered" id="order-table">
                <thead>
                    <tr>
                        <th>Название</th>
                        <th>ФИО директора</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for company in companies %}
                        <tr>
                            <td>{{ company.title }}</td>
                            <td>{{ company.full_name }}</td>
                            <td><a class="btn btn-mini" href="{% url "edit_company" %}?id={{ company.pk }}"><i class="icon-pencil"></i></a></td>
                            <td><a class="btn btn-mini delete-button" data-toggle="modal" href="#delete-company" value="{{ company.pk }}">
                                <i class="icon-remove"></i></a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
           <h5 class="center">Не было добавлено ни одной компании</h5>
        {% endif %}
        <a href="{% url "add_company" %}" class="btn">Добавить компанию</a>
    </div>
    <div class="modal hide fade" id="delete-company" tabindex="-1" role="dialog" aria-labelledby="clientInfoLabel" aria-hidden="true">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>Вы уверены, что хотите удалить эту компанию?</h3>
        </div>
        <div class="modal-footer">
            <a href="" id="delete__ok" class="btn btn-danger">Удалить</a>
            <button type="button" class="btn" data-dismiss="modal" aria-hidden="true">Закрыть</button>
        </div>
    </div>
    <script type="text/javascript">
        (function($){
            $(document).ready(function(){
                $("#order-table").dataTable({
                    "language": {
                        "url": "{{ STATIC_URL }}language/ru_RU.txt"
                    },
                    "aoColumnDefs": [
                        { "bSortable": false, "aTargets": [ 2, 3 ] },
                        { "bSearchable": false, "aTargets": [ 2, 3 ] }
                    ]
                });
                 $('.delete-button').bind('click', function(){
                    var id = $(this).attr('value');
                    $('#delete__ok').attr({'href': '{% url "delete_company" %}?id=' + id});
                });
            });
        })(jQuery);
    </script>
{%endblock%}